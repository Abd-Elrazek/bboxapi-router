<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Bbox-api-client by akinaru</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Bbox-api-client</h1>
      <h2 class="project-tagline">Java/Android client for using Bbox Json API</h2>
      <a href="https://github.com/akinaru/bbox-api-client" class="btn">View on GitHub</a>
      <a href="https://github.com/akinaru/bbox-api-client/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/akinaru/bbox-api-client/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="bbox-api-client-library" class="anchor" href="#bbox-api-client-library" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bbox Api client library</h1>

<p><a href="http://akinaru.github.io/bbox-api-client">http://akinaru.github.io/bbox-api-client</a></p>

<p><i>Last update on 23/09/2015</i></p>

<p>Library for using Bbox Json API opened in end of september 2015 on Bbox Sensation</p>

<p>These apis are used by Bbox management interface in hostname : gestionbbox.lan port 80</p>

<p>You must be on the same network as your Bbox to use them</p>

<p>last release : <a href="https://github.com/akinaru/bbox-api-client/releases/tag/1.0">https://github.com/akinaru/bbox-api-client/releases/tag/1.0</a></p>

<p>This README may contain inaccurate information about these api due to early release.</p>

<h3>
<a id="list-of-api-implemented" class="anchor" href="#list-of-api-implemented" aria-hidden="true"><span class="octicon octicon-link"></span></a>List of API implemented</h3>

<table>
<thead>
<tr>
<th>api</th>
<th>prototype</th>
<th>access</th>
<th>comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>summary</td>
<td><code>getSummary(IApiSummaryListener listener)</code></td>
<td>public</td>
<td>some information about Bbox</td>
</tr>
<tr>
<td>authentication</td>
<td><code>authenticate(String password, IAuthenticationListener authenticationListener)</code></td>
<td>public</td>
<td>authenticate to be able to use private API</td>
</tr>
<tr>
<td>voip</td>
<td><code>voipData(IVoipDataListener voipDataListener)</code></td>
<td>private</td>
<td>request voip data</td>
</tr>
<tr>
<td>device information</td>
<td><code>bboxDevice(IBboxDeviceListener deviceListener)</code></td>
<td>private</td>
<td>request specific information about box</td>
</tr>
<tr>
<td>full call log</td>
<td><code>getFullCallLog(IFullCallLogListener listener)</code></td>
<td>private</td>
<td>get call log since last reboot</td>
</tr>
<tr>
<td>hosts</td>
<td><code>getHosts(IHostsListener listener)</code></td>
<td>private</td>
<td>request list of known hosts</td>
</tr>
<tr>
<td>set wifi state</td>
<td><code>setWifiState(boolean state, IRequestStatusListener requestStatus)</code></td>
<td>private</td>
<td>set Wifi ON/OFF</td>
</tr>
<tr>
<td>set led state</td>
<td><code>setBboxDisplayState(boolean state, IRequestStatusListener requestStatus)</code></td>
<td>private</td>
<td>set Bbox led display ON/OFF</td>
</tr>
<tr>
<td>dial</td>
<td><code>voipDial(int lineNumber, String phone, IRequestStatusListener requestStatus)</code></td>
<td>private</td>
<td>dial a phone number on a line</td>
</tr>
</tbody>
</table>

<h3>
<a id="how-to-use-" class="anchor" href="#how-to-use-" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to use ?</h3>

<p>Instanciate BboxApi class</p>

<pre><code>import fr.bmartel.bboxapi.BboxApi;

.....

BboxApi apiWrapper = new BboxApi();
</code></pre>

<h3>
<a id="retrieve-summary-info" class="anchor" href="#retrieve-summary-info" aria-hidden="true"><span class="octicon octicon-link"></span></a>Retrieve summary info</h3>

<p>Summary information contains basic information about Bbox</p>

<p>Request summary information (no authentication required)</p>

<pre><code>apiWrapper.getSummary(new IApiSummaryListener() {

    @Override
    public void onApiSummaryReceived(ApiSummary summary) {

        //summary result received

    }

    @Override
    public void onApiSummaryFailure() {

        //summary request failure

    }
});
</code></pre>

<p><code>ApiSummary</code> object description </p>

<table>
<thead>
<tr>
<th>property</th>
<th>Type</th>
<th>comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>rxOccupation</code></td>
<td>int</td>
<td>RX occupation (in %)</td>
</tr>
<tr>
<td><code>txOccupation</code></td>
<td>int</td>
<td>TX occupation (in %)</td>
</tr>
<tr>
<td><code>hostList</code></td>
<td>List</td>
<td>List of hosts (see host api)</td>
</tr>
<tr>
<td><code>iptvAddr</code></td>
<td>String</td>
<td>IPTV broadcast address</td>
</tr>
<tr>
<td><code>iptvIpAddr</code></td>
<td>String</td>
<td>IPTV receiver address</td>
</tr>
<tr>
<td><code>iptvReceipt</code></td>
<td>int</td>
<td>-</td>
</tr>
<tr>
<td><code>iptvNumber</code></td>
<td>int</td>
<td>-</td>
</tr>
<tr>
<td><code>voipStatus</code></td>
<td>String</td>
<td>voip status ("Up" if online)</td>
</tr>
<tr>
<td><code>callState</code></td>
<td>CallState</td>
<td>voip callstate (IDLE,INCALL,OFFHOOK,OUTCALL)</td>
</tr>
<tr>
<td><code>message</code></td>
<td>int</td>
<td>number of vocal message</td>
</tr>
<tr>
<td><code>notanswered</code></td>
<td>int</td>
<td>number of not answered call</td>
</tr>
<tr>
<td><code>internetState</code></td>
<td>int</td>
<td>-</td>
</tr>
<tr>
<td><code>authenticated</code></td>
<td>int</td>
<td>0 if not authenticated / 1 if authenticated</td>
</tr>
<tr>
<td><code>displayState</code></td>
<td>boolean</td>
<td>true if Bbox led is ON / false for OFF</td>
</tr>
</tbody>
</table>

<h3>
<a id="authentication" class="anchor" href="#authentication" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authentication</h3>

<p>To request private api, you have to authenticate with your bbox management interface password :</p>

<pre><code>api.authenticate("your_password", new IAuthenticationListener() {

    @Override
    public void onAuthenticationSuccess(String token) {

        //successfull registration

    }

    @Override
    public void onAuthenticationError() {

        //failure registration
    }

});
</code></pre>

<p>If registration is successful, token is stored in RAM in Bboxapi object. Further call to BboxApi object will integrate a Cookie header with received token.</p>

<h3>
<a id="retrieve-bbox-device-info" class="anchor" href="#retrieve-bbox-device-info" aria-hidden="true"><span class="octicon octicon-link"></span></a>Retrieve Bbox device info</h3>

<p>Some information about Bbox : </p>

<pre><code>api.bboxDevice(new IBboxDeviceListener() {

    @Override
    public void onBboxDeviceReceived(BBoxDevice device) {

        //Bbox device request successfulll
    }

    @Override
    public void onBboxDeviceFailure() {

        //Bbox device request failure
    }

});
</code></pre>

<p><code>BBoxDevice</code> object description </p>

<table>
<thead>
<tr>
<th>property</th>
<th>Type</th>
<th>comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>status</code></td>
<td>int</td>
<td>-</td>
</tr>
<tr>
<td><code>bootNumber</code></td>
<td>int</td>
<td>number of boot</td>
</tr>
<tr>
<td><code>modelName</code></td>
<td>String</td>
<td>Bbox model name</td>
</tr>
<tr>
<td><code>userConfigured</code></td>
<td>boolean</td>
<td>define if user has already logged before</td>
</tr>
<tr>
<td><code>displayState</code></td>
<td>boolean</td>
<td>true if Bbox led is ON / false for OFF</td>
</tr>
<tr>
<td><code>firstuseDate</code></td>
<td>String</td>
<td>date of bbox first use</td>
</tr>
<tr>
<td><code>serialNumber</code></td>
<td>String</td>
<td>bbox serial number</td>
</tr>
</tbody>
</table>

<h3>
<a id="retrieve-known-host-list" class="anchor" href="#retrieve-known-host-list" aria-hidden="true"><span class="octicon octicon-link"></span></a>Retrieve known host list</h3>

<p>Get list of all host known by Bbox with firstseen and lastseen date</p>

<pre><code>api.getHosts(new IHostsListener() {

    @Override
    public void onHostsReceived(List&lt;Host&gt; hostList) {

        //host request successfull
    }

    @Override
    public void onHostsFailure() {

        //host request failure

    }
});
</code></pre>

<p>Result is a list of <code>Host</code> object define as following :</p>

<table>
<thead>
<tr>
<th>property</th>
<th>Type</th>
<th>comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>int</td>
<td>host id (begin from 1)</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td>String</td>
<td>host name</td>
</tr>
<tr>
<td><code>macaddress</code></td>
<td>String</td>
<td>host mac address</td>
</tr>
<tr>
<td><code>ipaddress</code></td>
<td>String</td>
<td>host IP address</td>
</tr>
<tr>
<td><code>type</code></td>
<td>String</td>
<td>"Static" or "STB"</td>
</tr>
<tr>
<td><code>link</code></td>
<td>String</td>
<td>type of link for this host (Wifi 2.4 / Wifi 5 / Offline)</td>
</tr>
<tr>
<td><code>devicetype</code></td>
<td>String</td>
<td>"Device" or "STB"</td>
</tr>
<tr>
<td><code>firstseen</code></td>
<td>String</td>
<td>host was first seen on this date</td>
</tr>
<tr>
<td><code>lastseen</code></td>
<td>String</td>
<td>host was last seen on this date</td>
</tr>
<tr>
<td><code>lease</code></td>
<td>int</td>
<td>lease time for this host</td>
</tr>
<tr>
<td><code>active</code></td>
<td>boolean</td>
<td>define if host is active</td>
</tr>
</tbody>
</table>

<h3>
<a id="retrieve-voip-data" class="anchor" href="#retrieve-voip-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Retrieve voip data</h3>

<p>Get voip information</p>

<pre><code>api.voipData(new IVoipDataListener() {

    @Override
    public void onVoipDataReceived(Voip voipData) {

        //voip request successfull

    }

    @Override
    public void onVoipDataFailure() {

        //voip request failure

    }

});
</code></pre>

<p>Result is a list of <code>Voip</code> object define as following :</p>

<table>
<thead>
<tr>
<th>property</th>
<th>Type</th>
<th>comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>int</td>
<td>-</td>
</tr>
<tr>
<td><code>status</code></td>
<td>String</td>
<td>voip status ("Up" if online)</td>
</tr>
<tr>
<td><code>callState</code></td>
<td>CallState</td>
<td>voip callstate (IDLE,INCALL,OFFHOOK,OUTCALL)</td>
</tr>
<tr>
<td><code>uri</code></td>
<td>String</td>
<td>SIP phone line</td>
</tr>
<tr>
<td><code>blockState</code></td>
<td>int</td>
<td>number of blocked call (to verify)</td>
</tr>
<tr>
<td><code>anoncallState</code></td>
<td>int</td>
<td>number of anonymous call</td>
</tr>
<tr>
<td><code>mwi</code></td>
<td>int</td>
<td>number of message waiting</td>
</tr>
<tr>
<td><code>messageCount</code></td>
<td>int</td>
<td>number of messages</td>
</tr>
<tr>
<td><code>notanswered</code></td>
<td>int</td>
<td>number of call not answered</td>
</tr>
</tbody>
</table>

<h3>
<a id="retrieve-list-of-call-log" class="anchor" href="#retrieve-list-of-call-log" aria-hidden="true"><span class="octicon octicon-link"></span></a>Retrieve list of call log</h3>

<p>Get full list of call log since last reboot</p>

<pre><code>api.getFullCallLog(new IFullCallLogListener() {

    @Override
    public void onFullCallLogReceived(List&lt;CallLog&gt; callLogList) {

        //call log request successfull

    }

    @Override
    public void onFullCallLogFailure() {

        //call log request failure
    }

});
</code></pre>

<p>Result is a list of <code>CallLog</code> object define as following :</p>

<table>
<thead>
<tr>
<th>property</th>
<th>Type</th>
<th>comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>int</td>
<td>call id</td>
</tr>
<tr>
<td><code>number</code></td>
<td>String</td>
<td>phone number</td>
</tr>
<tr>
<td><code>date</code></td>
<td>long</td>
<td>call date</td>
</tr>
<tr>
<td><code>type</code></td>
<td>CallType</td>
<td>call type (INCALL / OUTCALL)</td>
</tr>
<tr>
<td><code>answered</code></td>
<td>boolean</td>
<td>define if call was answered or not</td>
</tr>
<tr>
<td><code>duration</code></td>
<td>int</td>
<td>call duration (answered or not)</td>
</tr>
</tbody>
</table>

<hr>

<h3>
<a id="dial-a-phone-number---trigger-phone-ring-before-call" class="anchor" href="#dial-a-phone-number---trigger-phone-ring-before-call" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dial a phone number - Trigger phone ring before call</h3>

<p>Dial a specified phone number. Phone will ring and call will be processed once user hookoff</p>

<pre><code>api.voipDial(1,"0666666666",new IRequestStatusListener() {

    @Override
    public void onSuccess() {

        //voip dial success

    }

    @Override
    public void onFailure() {

        //voip dial failure

    }
});
</code></pre>

<p>Input  :</p>

<ul>
<li>line number (int) : 1 or 2 according to the line on which you plugged your phone</li>
<li>phone number (String) : number to call</li>
<li>task completion listener (IRequestStatusListener) : retrieve asynchronous task completion or failure</li>
</ul>

<h3>
<a id="set-bbox-led-state" class="anchor" href="#set-bbox-led-state" aria-hidden="true"><span class="octicon octicon-link"></span></a>Set Bbox led state</h3>

<p>Switch led display to ON / OFF on Bbox </p>

<pre><code>api.setBboxDisplayState(true, new IRequestStatusListener() {

    @Override
    public void onSuccess() {
        //box display set success
    }

    @Override
    public void onFailure() {
        //box display set failure
    }
});
</code></pre>

<p>Input : </p>

<ul>
<li>display state (boolean) </li>
<li>task completion listener (IRequestStatusListener) :  retrieve asynchronous task completion or failure</li>
</ul>

<h3>
<a id="set-wifi-state" class="anchor" href="#set-wifi-state" aria-hidden="true"><span class="octicon octicon-link"></span></a>Set Wifi state</h3>

<p>Switch Wifi to ON/OFF </p>

<pre><code>api.setWifiState(true, new IRequestStatusListener() {

    @Override
    public void onSuccess() {
        //box wifi set status success
    }

    @Override
    public void onFailure() {
        //box wifi set status failure
    }

});
</code></pre>

<p>Input : </p>

<ul>
<li>wifi state (boolean) </li>
<li>task completion listener (IRequestStatusListener) :  retrieve asynchronous task completion or failure</li>
</ul>

<hr>

<h2>
<a id="testing-bbox-apis" class="anchor" href="#testing-bbox-apis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Testing Bbox APIs</h2>

<ul>
<li>You can test all previous API in java project bbox-api-client-test :</li>
</ul>

<pre><code>cd ./bbox-api-client-test/release
java -jar bbox-api-client-test-1.0.jar
</code></pre>

<ul>
<li>You can test Bbox API with a Linux Bash script <code>bboxapi-curl.sh</code> script accomplishing authentication, request voip data and dial a number.</li>
</ul>

<p>Usage :</p>

<pre><code>./bboxapi-curl.sh &lt;your_password&gt; &lt;phone_number&gt;
</code></pre>

<hr>

<p><b>External JAVA Library</b></p>

<ul>
<li><p>json-simple  : <a href="http://code.google.com/p/json-simple/">http://code.google.com/p/json-simple/</a></p></li>
<li><p>clientsocket : <a href="https://github.com/akinaru/socket-multiplatform/tree/master/client/socket-client/java">https://github.com/akinaru/socket-multiplatform/tree/master/client/socket-client/java</a></p></li>
<li><p>http-endec   : <a href="https://github.com/akinaru/http-endec-java">https://github.com/akinaru/http-endec-java</a></p></li>
</ul>

<p><b>TODO</b></p>

<ul>
<li>authentication session timeout</li>
<li>more APIs left to implement</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/akinaru/bbox-api-client">Bbox-api-client</a> is maintained by <a href="https://github.com/akinaru">akinaru</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
